# 🖥️ Omega更新包管理GUI工具使用指南

## 📋 工具介绍

这是一个集成的可视化Omega更新包管理工具，提供友好的图形界面来：
- **制作更新包**：分析版本差异，制作增量和完整更新包
- **上传更新包**：将制作好的更新包上传到服务器
- **版本管理**：查看和管理现有版本
- **操作日志**：监控所有操作的详细日志
- **服务器连接**：测试和配置服务器连接
- **🆕 自动保存配置**：记住您的所有设置，下次使用时无需重新配置

## 🚀 启动方法

### Windows用户
```cmd
# 双击运行
start_gui.bat

# 或在命令行中运行
python omega_update_gui.py
```

### Linux/Mac用户
```bash
# 给脚本执行权限
chmod +x start_gui.sh

# 运行脚本
./start_gui.sh

# 或直接运行Python程序
python3 omega_update_gui.py
```

## 📦 依赖要求

- Python 3.6+
- tkinter (通常随Python安装)
- requests (自动安装)

## 🔧 功能说明

### 1. 服务器配置
- **服务器地址**: 默认为 `http://update.chpyke.cn`
- **API密钥**: 默认已填入您的密钥 `dac450db3ec47d79196edb7a34defaed`
- **测试连接**: 验证服务器是否可访问
- **显示/隐藏密钥**: 切换密钥显示状态
- **🆕 重置配置**: 将所有设置恢复为默认值
- **🆕 自动保存**: 所有配置修改会自动保存，无需手动操作

### 2. 制作更新包 ⭐ 新功能
#### 版本目录选择
- **旧版本目录**: 选择基础版本目录 (如: omega_dist/omega_1_7_3)
- **新版本目录**: 选择目标版本目录 (如: omega_dist/omega_2_2_5)

#### 输出设置
- **输出目录**: 更新包保存位置 (默认: updates)
- **包名前缀**: 更新包文件名前缀 (默认: omega)

#### 更新包类型
- **仅增量包**: 只制作增量更新包 (体积小，升级快)
- **仅完整包**: 只制作完整安装包 (适合全新安装)
- **两种都制作**: 同时制作增量包和完整包 (推荐)

#### 高级选项
- **制作完成后自动上传**: 制作完成后自动上传到服务器
- **高压缩率**: 使用最高压缩级别减小文件体积
- **先分析版本差异**: 制作前先分析两个版本的差异

#### 操作按钮
- **分析版本差异**: 查看两个版本之间的详细差异
- **制作更新包**: 根据设置制作更新包
- **一键制作并上传**: 制作完成后自动上传

### 3. 上传更新包
#### 文件选择
- 点击"浏览"按钮选择更新包文件
- 支持的格式: .zip, .tar.gz, .rar, .exe, .msi
- 程序会自动尝试从文件名提取版本号

#### 版本信息
- **版本号**: 输入版本号 (如: 2.2.5)
- **平台**: 选择目标平台 (windows/linux/macos)
- **架构**: 选择目标架构 (x64/x86/arm64)
- **描述**: 输入版本更新说明

#### 选项
- **稳定版本**: 标记为稳定发布版本
- **重要更新**: 标记为重要安全更新

#### 上传过程
- 点击"上传更新包"开始上传
- 进度条显示上传进度
- 上传完成后自动刷新版本列表

### 3. 版本管理
- **版本列表**: 显示所有已上传的版本
- **刷新列表**: 重新加载版本信息
- **查看详情**: 显示选中版本的详细信息
- **下载链接**: 复制版本检查API链接

### 5. 操作日志
- 显示所有操作的详细日志
- 包含时间戳和操作结果
- 可清除历史日志

## 📊 使用示例

### 制作并上传更新包 (推荐流程)
1. 在"制作更新包"标签页中
2. 选择旧版本目录: `omega_dist/omega_1_7_3`
3. 选择新版本目录: `omega_dist/omega_2_2_5`
4. 设置输出目录: `updates`
5. 选择"两种都制作"
6. 勾选"制作完成后自动上传"和"先分析版本差异"
7. 点击"一键制作并上传"
8. 查看分析报告，确认后制作更新包
9. 自动上传到服务器

### 手动上传现有文件
1. 在"上传更新包"标签页中
2. 点击"浏览"选择更新包文件
3. 输入版本号 (如: 2.3.0)
4. 选择平台和架构
5. 输入更新描述
6. 勾选相应选项
7. 点击"上传更新包"

### 查看版本列表
1. 切换到"版本管理"标签页
2. 点击"刷新列表"加载最新数据
3. 选择版本查看详情
4. 复制下载链接供客户端使用

## 🔍 故障排除

### 连接失败
- 检查服务器地址是否正确
- 确认服务器正在运行
- 检查网络连接

### 上传失败
- 验证API密钥是否正确
- 检查文件是否存在且可读
- 确认文件大小不超过限制 (100MB)
- 检查版本号是否已存在

### 界面问题
- 确保Python版本 >= 3.6
- 检查tkinter是否正确安装
- 尝试重新启动程序

## 🔐 安全注意事项

1. **API密钥保护**
   - 不要在公共场所显示API密钥
   - 定期更换API密钥
   - 不要将密钥提交到版本控制系统

2. **文件安全**
   - 确保上传的文件来源可信
   - 验证文件完整性
   - 避免上传包含敏感信息的文件

## 📞 技术支持

如果遇到问题：

1. **查看日志**: 在"操作日志"标签页查看详细错误信息
2. **测试连接**: 使用"测试连接"功能验证服务器状态
3. **检查配置**: 确认服务器地址和API密钥正确

## 🎯 快速开始

1. **启动程序**:
   ```bash
   python omega_update_gui.py
   ```

2. **测试连接**:
   - 点击"测试连接"按钮
   - 确认显示"连接成功"

3. **上传第一个版本**:
   - 选择更新包文件
   - 输入版本号 "2.2.5"
   - 添加描述 "初始版本"
   - 点击上传

4. **验证上传**:
   - 切换到"版本管理"标签页
   - 查看新上传的版本

## 🔧 配置管理功能

### 自动保存配置
工具会自动保存您的所有设置，包括：
- 服务器地址和API密钥
- 版本目录路径（旧版本、新版本）
- 输出设置（输出目录、包名前缀）
- 更新包类型选择（增量包、完整包、两种都制作）
- 高级选项（自动上传、高压缩、先分析版本差异）

### 配置文件位置
配置保存在 `deployment/gui_config.json` 文件中，格式为JSON。

### 重置配置
如果需要恢复默认设置：
1. 点击服务器配置区域的"重置配置"按钮
2. 确认重置操作
3. 所有设置将恢复为默认值

### 配置备份
建议定期备份 `gui_config.json` 文件，以便在需要时恢复您的个人设置。

## 🎉 完成！

现在您可以使用这个可视化工具轻松管理Omega更新包了！

---

**提示**:
- 工具会记住您的所有设置，下次使用时无需重新配置
- 建议将此工具保存在安全的位置，并定期备份配置信息
- 如遇到配置问题，可使用"重置配置"功能恢复默认设置
